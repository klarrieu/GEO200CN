---
title: "GEO 200CN Lab 1"
author: "Kenneth Larrieu"
date: "April 1, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1


__Carefully read chapter 1 to 6 in http://rspatial.org/intr/ __


__1) Read and explore data __

There are two text files with data (loblolly.dat) and (ChickWeightSub.csv). 

Write a script (including brief comments) that

a) Reads them into R

```{r}
loblolly = read.delim('loblolly.dat', sep=' ')
chickweights = read.csv('ChickWeightSub.csv')
```

b) for both data sets, lists all the variable names

```{r}
colnames(loblolly)
colnames(chickweights)
```

c) for each variable in one of the data sets, use a function to compute the min and a function to compute the mean value 

```{r}
# apply the corresponding functions column-wise (axis 2)
apply(loblolly, 2, min)
apply(loblolly, 2, mean)
```

d) now pick one variable from one data set and use functions summary, table, quantile, and boxplot

```{r}
h = loblolly$height
summary(h)
table(h)
quantile(h)
boxplot(h)
```


## Part 2

__Carefully read chapter 7 to 14 in http://rspatial.org/intr/ __


__2) Functions__

a) Use the files from lab 1 to compute mean values for each variable using 'apply'

```{r}

```

b) Write a function 'f' that behaves like this:

```{r eval=FALSE}
> f('Jim')
[1] "hello Jim, how are you"
```

```{r}
f = function(string){
  return(sprintf('hello %s, how are you', string))
}
# use test example
f('Jim')
```

c) Write a function 'sumOfSquares' that behaves like this:

```{r eval=FALSE}
> d <- c(1,5,2,4,6,2,4,5)
> sumOfSquares(d)
[1] 21.875
```

To compute the "sum of squares", subtract the mean value of all numbers from each number. Square these numbers and sum them.

```{r}
sumOfSquares = function(v){
  # subtract mean from all values, then square all values, then aggregate by summing
  return(sum((v - mean(v))^2))
}
# use test example
d = c(1,5,2,4,6,2,4,5)
sumOfSquares(d)
```


__3) Data preparation__. Use the data in "students.csv" and "scores.dat" to assess if there is a relation between the "group" or "age" of a student and their average score and for the three subjects (math, english, geography)

a) use reshape and merge to combine the two data sets

```{r}
students = read.csv('students.csv')
scores = read.delim('scores.dat', sep=' ', na.strings='-999') # set -999 in original data set to NA type
# reshape so we have a column for each unique 'subject' value, using 'student' to identify corresponding row
scores = reshape(scores, idvar='student', timevar='subject', direction='wide')
# then merge data frames using the fact that 'students' in first data frame corresponds to 'student' in second data frame 
merged_data = merge(students, scores, by.x='students', by.y='student')
# for each column, average the score columns
merged_data['avg_score'] = rowMeans(merged_data[,-1:-3])
merged_data
```

b) compute correlation coefficients

```{r}
# correlation coefficient matrix for all variable pairs in merged_data, omitting student column
# calculate correlations only using pairs of values for which neither is NA
corr_df = cor(merged_data[-1], use="pairwise.complete.obs")
# remove irrelevant/repeated values
corr_df = corr_df[1:2, -1:-2]
corr_df
```

c) produce a relevant plot

```{r}
# plot group and age vs scores in math, english, geography, and average scores
par(mfrow=c(2,4))
dev.size = c(40,40)
for (x in colnames(merged_data[2:3])){
  for (y in colnames(merged_data[4:7])){
    plot(merged_data[[x]], merged_data[[y]], xlab=x, ylab=y, pch=19)
  }
}
```
